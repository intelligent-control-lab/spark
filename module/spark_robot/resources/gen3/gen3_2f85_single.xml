<mujoco model="gen3_2f85">
	<!-- ========================================================= -->
    <!-- Compiler & Options                                        -->
    <!-- ========================================================= -->
    <compiler angle="radian" meshdir="meshes" autolimits="true"/>
    <option integrator="implicitfast"/>

    <!-- ========================================================= -->
    <!-- Assets: Materials & Meshes                                -->
    <!-- ========================================================= -->
    <asset>

        <!-- Materials -->
        <material name="iiwa14_gray"    rgba="0.4 0.4 0.4 1"/>
        <material name="collision_gray" rgba="0.4 0.4 0.4 0"/>
        <material name="light_gray"     rgba="0.6 0.6 0.6 1"/>
        <material name="black"          rgba="0 0 0 1"/>
        <material name="orange"         rgba="1 0.423529 0.0392157 1"/>
        <material name="metal"          rgba="0.58 0.58 0.58 1"/>
        <material name="silicone"       rgba="0.1882 0.1882 0.1882 1"/>
        <material name="gray"           rgba="0.4627 0.4627 0.4627 1"/>
        <material name="BeigeMaterial"
                  rgba="0.26 0.16 0.16796875 1"
                  specular="0"
                  shininess="0"
                  reflectance="0"
                  emission="0"/>

        <!-- Gen3 Arm Meshes -->
        <mesh name="Base_Link"            file="gen3/base_link.STL"/>
        <mesh name="Shoulder_Link"        file="gen3/shoulder_link.STL"/>
        <mesh name="HalfArm1_Link"        file="gen3/half_arm_1_link.STL"/>
        <mesh name="HalfArm2_Link"        file="gen3/half_arm_2_link.STL"/>
        <mesh name="ForeArm_Link"         file="gen3/forearm_link.STL"/>
        <mesh name="SphericalWrist1_Link" file="gen3/spherical_wrist_1_link.STL"/>
        <mesh name="SphericalWrist2_Link" file="gen3/spherical_wrist_2_link.STL"/>
        <mesh name="Bracelet_Link"        file="gen3/bracelet_with_vision_link.STL"/>

        <!-- Robotiq 2F85 Meshes -->
        <mesh class="2f85" file="robotiq_2f85/base_mount.stl"   scale="0.001 0.001 0.001"/>
        <mesh class="2f85" file="robotiq_2f85/base.stl"         scale="0.001 0.001 0.001"/>
        <mesh class="2f85" file="robotiq_2f85/driver.stl"       scale="0.001 0.001 0.001"/>
        <mesh class="2f85" file="robotiq_2f85/coupler.stl"      scale="0.001 0.001 0.001"/>
        <mesh class="2f85" file="robotiq_2f85/follower.stl"     scale="0.001 0.001 0.001"/>
        <mesh class="2f85" file="robotiq_2f85/pad.stl"          scale="0.001 0.001 0.001"/>
        <mesh class="2f85" file="robotiq_2f85/silicone_pad.stl" scale="0.001 0.001 0.001"/>
        <mesh class="2f85" file="robotiq_2f85/spring_link.stl"  scale="0.001 0.001 0.001"/>

    </asset>

    <!-- ========================================================= -->
    <!-- Visualization                                             -->
    <!-- ========================================================= -->
    <visual>
        <headlight diffuse="0.6 0.6 0.6"
                   ambient="0.3 0.3 0.3"
                   specular="0 0 0"/>
        <global azimuth="-130" elevation="-20"/>
    </visual>

    <!-- ========================================================= -->
    <!-- Environment Assets                                        -->
    <!-- ========================================================= -->
    <asset>
        <texture type="skybox"
                 builtin="gradient"
                 rgb1="1 1 1"
                 rgb2="1 1 1"
                 width="512"
                 height="3072"/>
        <texture type="2d"
                 name="groundplane"
                 builtin="checker"
                 mark="edge"
                 rgb1="1 1 1"
                 rgb2="1 1 1"
                 markrgb="0 0 0"
                 width="300"
                 height="300"/>
        <material name="groundplane"
                  texture="groundplane"
                  texuniform="true"
                  texrepeat="5 5"
                  reflectance="0.2"/>
    </asset>

    <!-- ========================================================= -->
    <!-- Defaults                                                  -->
    <!-- ========================================================= -->
    <default>

        <default class="gen3">
            <joint axis="0 0 1"/>
            <general gaintype="fixed"
                     biastype="affine"
                     gainprm="2000"
                     biasprm="0 -2000 -200"/>
        </default>

        <default class="2f85">
            <general biastype="affine"/>
            <joint axis="1 0 0"/>

            <default class="driver">
                <joint range="0 0.8"
                       armature="0.005"
                       damping="0.1"
                       solimplimit="0.95 0.99 0.001"
                       solreflimit="0.005 1"/>
            </default>

            <default class="follower">
                <joint range="-0.872664 0.872664"
                       armature="0.001"
                       pos="0 -0.018 0.0065"
                       solimplimit="0.95 0.99 0.001"
                       solreflimit="0.005 1"/>
            </default>

            <default class="spring_link">
                <joint range="-0.29670597283 0.8"
                       armature="0.001"
                       stiffness="0.05"
                       springref="2.62"
                       damping="0.00125"/>
            </default>

            <default class="coupler">
                <joint range="-1.57 0"
                       armature="0.001"
                       solimplimit="0.95 0.99 0.001"
                       solreflimit="0.005 1"/>
            </default>

            <default class="visual2">
                <geom type="mesh"
                      contype="0"
                      conaffinity="0"
                      group="2"/>
            </default>

            <default class="collision2">
                <geom type="mesh" group="3"/>

                <default class="pad_box1">
                    <geom type="box"
                          mass="0"
                          pos="0 -0.0026 0.028125"
                          size="0.011 0.004 0.009375"
                          friction="0.7"
                          solimp="0.95 0.99 0.001"
                          solref="0.004 1"
                          priority="1"
                          rgba="0.55 0.55 0.55 1"/>
                </default>

                <default class="pad_box2">
                    <geom type="box"
                          mass="0"
                          pos="0 -0.0026 0.009375"
                          size="0.011 0.004 0.009375"
                          friction="0.6"
                          solimp="0.95 0.99 0.001"
                          solref="0.004 1"
                          priority="1"
                          rgba="0.45 0.45 0.45 1"/>
                </default>
            </default>
        </default>
    </default>

	<!-- ========================================================= -->
    <!-- World Body (Robot + Gripper)                               -->
    <!-- ========================================================= -->

	<worldbody>
	
		<light pos="0 0 1.5" dir="0 0 -1" directional="true"/>
		<geom name="floor" size="0 0 0.05" type="plane" material="groundplane"/>
 
		<body name="robot" pos="0 0 0" childclass="gen3">
			<inertial pos="-0.000648 -0.000166 0.084487" mass="5.697353" diaginertia="0.004622 0.004495 0.002079"/>
			<geom type="mesh" rgba="0.79216 0.81961 0.93333 1" mesh="Base_Link"/>
        
			<body name="Shoulder_Link" pos="6.1995e-05 0 0.15643" quat="-3.67321e-06 -1 0 0">
				<inertial pos="-2.3e-05 -0.010364 -0.07336" mass="1.37735" diaginertia="0.00457 0.004831 0.001409"/>
				<joint name="joint_1" pos="0 0 0" axis="0 0 1" limited="true" range="-2.5656 2.5656"/>
				<geom type="mesh" rgba="0.75294 0.75294 0.75294 1" mesh="Shoulder_Link"/>

				<body name="HalfArm1_Link" pos="0 0.005375 -0.12838" quat="0.707105 0.707108 0 0">
					<inertial pos="-4.4e-05 -0.09958 -0.013278" quat="0.482348 0.516286 -0.516862 0.483366" mass="1.16367" diaginertia="0.0113017 0.011088 0.00102532"/>
					<joint name="joint_2" pos="0 0 0" axis="0 0 1" limited="true" range="-2.2 2.2"/>
					<geom type="mesh" rgba="0.75294 0.75294 0.75294 1" mesh="HalfArm1_Link"/>

					<body name="HalfArm2_Link" pos="0 -0.21038 -0.006375" quat="0.707105 -0.707108 0 0">
						<inertial pos="-4.4e-05 -0.006641 -0.117892" quat="0.706144 0.0213722 -0.0209128 0.707437" mass="1.16366" diaginertia="0.0111633 0.010932 0.00100671"/>
						<joint name="joint_3" pos="0 0 0" axis="0 0 1"/>
						<geom type="mesh" rgba="0.75294 0.75294 0.75294 1" mesh="HalfArm2_Link"/>

						<body name="ForeArm_Link" pos="0 0.006375 -0.21038" quat="0.707105 0.707108 0 0">
							<inertial pos="-1.8e-05 -0.075478 -0.015006" quat="0.483678 0.515961 -0.515859 0.483455" mass="0.930287" diaginertia="0.00834839 0.008147 0.000598606"/>
							<joint name="joint_4" pos="0 0 0" axis="0 0 1" limited="true" range="-2.5656 2.5656"/>
							<geom type="mesh" rgba="0.75294 0.75294 0.75294 1" mesh="ForeArm_Link"/>

							<body name="SphericalWrist1_Link" pos="0 -0.20843 -0.006375" quat="0.707105 -0.707108 0 0">
								<inertial pos="1e-06 -0.009432 -0.063883" quat="0.703558 0.0707492 -0.0707492 0.703558" mass="0.678106" diaginertia="0.00165901 0.001596 0.000346988"/>
								<joint name="joint_5" pos="0 0 0" axis="0 0 1"/>
								<geom type="mesh" rgba="0.75294 0.75294 0.75294 1" mesh="SphericalWrist1_Link"/>

								<body name="SphericalWrist2_Link" pos="0 0.00017505 -0.10593" quat="0.707105 0.707108 0 0">
									<inertial pos="1e-06 -0.045483 -0.00965" quat="0.44426 0.550121 -0.550121 0.44426" mass="0.678106" diaginertia="0.00170087 0.001641 0.00035013"/>
									<joint name="joint_6" pos="0 0 0" axis="0 0 1" limited="true" range="-2.05 2.05"/>
									<geom type="mesh" rgba="0.75294 0.75294 0.75294 1" mesh="SphericalWrist2_Link"/>

									<body name="Bracelet_Link" pos="0 -0.10593 -0.00017505" quat="0.707105 -0.707108 0 0">
										<inertial pos="-0.000281 -0.011402 -0.03108" quat="0.592556 0.413116 -0.393675 0.568536" mass="0.500657" diaginertia="0.000650457 0.00056985 0.000310694"/>
										<joint name="joint_7" pos="0 0 0" axis="0 0 1"/>
										<geom type="mesh" rgba="0.75294 0.75294 0.75294 1" mesh="Bracelet_Link"/>
										<body name="right/flange" pos="0 0 -0.064" quat="0 -1 0 0">
											<!-- <site name="right/tcp" pos="0 0 0" size="0.01" rgba="0 1 0 0.5" group="2" /> -->
											<body name="right/2f85_base" pos="0 0 0.007" childclass="2f85">
											<!-- <joint name="2f85" type="free" /> -->
												<geom class="visual2" mesh="base_mount" material="black"/>
												<geom class="collision2" mesh="base_mount"/>
												<body name="right/gripper_base" pos="0 0 0.0038" quat="1 0 0 -1">
													<inertial mass="0.777441" pos="0 -2.70394e-05 0.0354675" quat="1 -0.00152849 0 0"
														diaginertia="0.000260285 0.000225381 0.000152708"/>
													<geom class="visual2" mesh="base" material="black"/>
													<geom class="collision2" mesh="base"/>
													<site name="right/pinch" pos="0 0 0.145" type="sphere" group="5" rgba="0.9 0.9 0.9 1" size="0.005"/>
													<!-- Right-hand side 4-bar linkage -->
													<body name="right/right_driver" pos="0 0.0306011 0.054904">
														<inertial mass="0.00899563" pos="2.96931e-12 0.0177547 0.00107314" quat="0.681301 0.732003 0 0"
														diaginertia="1.72352e-06 1.60906e-06 3.22006e-07"/>
														<joint name="right/right_driver_joint" class="driver"/>
														<geom class="visual2" mesh="driver" material="gray"/>
														<geom class="collision2" mesh="driver"/>
														<body name="right/right_coupler" pos="0 0.0315 -0.0041">
														<inertial mass="0.0140974" pos="0 0.00301209 0.0232175" quat="0.705636 -0.0455904 0.0455904 0.705636"
															diaginertia="4.16206e-06 3.52216e-06 8.88131e-07"/>
														<joint name="right/right_coupler_joint" class="coupler"/>
														<geom class="visual2" mesh="coupler" material="black"/>
														<geom class="collision2" mesh="coupler"/>
														</body>
													</body>
													<body name="right/right_spring_link" pos="0 0.0132 0.0609">
														<inertial mass="0.0221642" pos="-8.65005e-09 0.0181624 0.0212658" quat="0.663403 -0.244737 0.244737 0.663403"
														diaginertia="8.96853e-06 6.71733e-06 2.63931e-06"/>
														<joint name="right/right_spring_link_joint" class="spring_link"/>
														<geom class="visual2" mesh="spring_link" material="black"/>
														<geom class="collision2" mesh="spring_link"/>
														<body name="right/right_follower" pos="0 0.055 0.0375">
														<inertial mass="0.0125222" pos="0 -0.011046 0.0124786" quat="1 0.1664 0 0"
															diaginertia="2.67415e-06 2.4559e-06 6.02031e-07"/>
														<joint name="right/right_follower_joint" class="follower"/>
														<geom class="visual2" mesh="follower" material="black"/>
														<geom class="collision2" mesh="follower"/>
														<body name="right/right_pad" pos="0 -0.0189 0.01352">
															<geom class="pad_box1" name="right/right_pad1"/>
															<geom class="pad_box2" name="right/right_pad2"/>
															<inertial mass="0.0035" pos="0 -0.0025 0.0185" quat="0.707107 0 0 0.707107"
															diaginertia="4.73958e-07 3.64583e-07 1.23958e-07"/>
															<geom class="visual2" mesh="pad"/>
															<body name="right/right_silicone_pad">
															<geom class="visual2" mesh="silicone_pad" material="black"/>
															</body>
														</body>
														</body>
													</body>
													<!-- Left-hand side 4-bar linkage -->
													<body name="right/left_driver" pos="0 -0.0306011 0.054904" quat="0 0 0 1">
														<inertial mass="0.00899563" pos="0 0.0177547 0.00107314" quat="0.681301 0.732003 0 0"
														diaginertia="1.72352e-06 1.60906e-06 3.22006e-07"/>
														<joint name="right/left_driver_joint" class="driver"/>
														<geom class="visual2" mesh="driver" material="gray"/>
														<geom class="collision2" mesh="driver"/>
														<body name="right/left_coupler" pos="0 0.0315 -0.0041">
														<inertial mass="0.0140974" pos="0 0.00301209 0.0232175" quat="0.705636 -0.0455904 0.0455904 0.705636"
															diaginertia="4.16206e-06 3.52216e-06 8.88131e-07"/>
														<joint name="right/left_coupler_joint" class="coupler"/>
														<geom class="visual2" mesh="coupler" material="black"/>
														<geom class="collision2" mesh="coupler"/>
														</body>
													</body>
													<body name="right/left_spring_link" pos="0 -0.0132 0.0609" quat="0 0 0 1">
														<inertial mass="0.0221642" pos="-8.65005e-09 0.0181624 0.0212658" quat="0.663403 -0.244737 0.244737 0.663403"
														diaginertia="8.96853e-06 6.71733e-06 2.63931e-06"/>
														<joint name="right/left_spring_link_joint" class="spring_link"/>
														<geom class="visual2" mesh="spring_link" material="black"/>
														<geom class="collision2" mesh="spring_link"/>
														<body name="right/left_follower" pos="0 0.055 0.0375">
														<inertial mass="0.0125222" pos="0 -0.011046 0.0124786" quat="1 0.1664 0 0"
															diaginertia="2.67415e-06 2.4559e-06 6.02031e-07"/>
														<joint name="right/left_follower_joint" class="follower"/>
														<geom class="visual2" mesh="follower" material="black"/>
														<geom class="collision2" mesh="follower"/>
														<body name="right/left_pad" pos="0 -0.0189 0.01352">
															<geom class="pad_box1" name="right/left_pad1"/>
															<geom class="pad_box2" name="right/left_pad2"/>
															<inertial mass="0.0035" pos="0 -0.0025 0.0185" quat="1 0 0 1"
															diaginertia="4.73958e-07 3.64583e-07 1.23958e-07"/>
															<geom class="visual2" mesh="pad"/>
															<body name="right/left_silicone_pad">
															<geom class="visual2" mesh="silicone_pad" material="black"/>
															</body>
														</body>
														</body>
													</body>
												</body>
											</body>
										</body>
									</body>
								</body>
							</body>
						</body>
					</body>
				</body>
			</body>

        </body>
	</worldbody>

	<!-- ========================================================= -->
    <!-- Tendons                                                   -->
    <!-- ========================================================= -->
    <tendon>
        <fixed name="split">
            <joint joint="right/right_driver_joint" coef="0.5"/>
            <joint joint="right/left_driver_joint"  coef="0.5"/>
        </fixed>
    </tendon>

    <!-- ========================================================= -->
    <!-- Contacts                                                  -->
    <!-- ========================================================= -->
    <contact>
        <exclude body1="right/gripper_base" body2="right/left_driver"/>
        <exclude body1="right/gripper_base" body2="right/right_driver"/>
        <exclude body1="right/gripper_base" body2="right/left_spring_link"/>
        <exclude body1="right/gripper_base" body2="right/right_spring_link"/>
        <exclude body1="right/right_coupler" body2="right/right_follower"/>
        <exclude body1="right/left_coupler"  body2="right/left_follower"/>
    </contact>

    <!-- ========================================================= -->
    <!-- Equality Constraints                                      -->
    <!-- ========================================================= -->
    <equality>
        <connect body1="right/right_follower"
                 body2="right/right_coupler"
                 anchor="0 0 0"
                 solimp="0.95 0.99 0.001"
                 solref="0.005 1"/>

        <connect body1="right/left_follower"
                 body2="right/left_coupler"
                 anchor="0 0 0"
                 solimp="0.95 0.99 0.001"
                 solref="0.005 1"/>

        <joint joint1="right/right_driver_joint"
               joint2="right/left_driver_joint"
               polycoef="0 1 0 0 0"
               solimp="0.95 0.99 0.001"
               solref="0.005 1"/>
    </equality>

	<!-- ========================================================= -->
    <!-- Actuators                                                 -->
    <!-- ========================================================= -->
    <actuator>
        <general name="Shoulder_Link_actuator"        joint="joint_1" class="gen3" ctrlrange="-2.9 2.9" forcerange="-120 120"/>
        <general name="HalfArm1_Link_actuator"        joint="joint_2" class="gen3" ctrlrange="-2.1 2.1" forcerange="-120 120"/>
        <general name="HalfArm2_Link_actuator"        joint="joint_3" class="gen3" ctrlrange="-2.9 2.9" forcerange="-120 120"/>
        <general name="ForeArm_Link_actuator"         joint="joint_4" class="gen3" ctrlrange="-2.6 2.6" forcerange="-100 100"/>
        <general name="SphericalWrist1_Link_actuator" joint="joint_5" class="gen3" ctrlrange="-2.6 2.6" forcerange="-60 60"/>
        <general name="SphericalWrist2_Link_actuator" joint="joint_6" class="gen3" ctrlrange="-2.6 2.6" forcerange="-60 60"/>
        <general name="Bracelet_Link_actuator"        joint="joint_7" class="gen3" ctrlrange="-3.1 3.1" forcerange="-40 40"/>

        <general class="2f85"
                 name="right/fingers_actuator"
                 tendon="split"
                 ctrlrange="0 255"
                 forcerange="-5 5"
                 gainprm="0.3137255 0 0"
                 biasprm="0 -100 -10"/>
    </actuator>

</mujoco>

